clear('all');
clc

% set(0,'RecursionLimit',1000)

% RSA-768 (232 digits)
% p_bigd = java.math.BigDecimal('33478071698956898786044169848212690817704794983713768568912431388982883793878002287614711652531743087737814467999489');
% q_bigd = java.math.BigDecimal('36746043666799590428244633799627952632279158164343087642676032283815739666511279233373417143396810270092798736308917');



% RSA-576
p_bigd = java.math.BigDecimal('398075086424064937397125500550386491199064362342526708406385189575946388957261768583317');

q_bigd = java.math.BigDecimal('472772146107435302536223071973048224632914695302097116459852171130520711256363590397527');

% RSA-180
% p_bigd = java.math.BigDecimal('400780082329750877952581339104100572526829317815807176564882178998497572771950624613470377');
% q_bigd = java.math.BigDecimal('476939688738611836995535477357070857939902076027788232031989775824606225595773435668861833');

% RSA-100
% p_bigd = java.math.BigDecimal('37975227936943673922808872755445627854565536638199');
% q_bigd = java.math.BigDecimal('40094690950920881030683735292761468389214899724061');

% p_bigd = java.math.BigDecimal('9999973');
% q_bigd = java.math.BigDecimal('9999991');


tic
[n_bigd, g_bigd, lambda_bigd, mu_bigd] = javaPaillierKeygen(p_bigd, q_bigd);

m_bigd = java.math.BigDecimal('0')
r_bigd = java.math.BigDecimal('3');
c_bigd = javaPaillierEncrypt(m_bigd, n_bigd, g_bigd, r_bigd)
recM_bigd = javaPaillierDecrypt(c_bigd, n_bigd, lambda_bigd, mu_bigd)
toc
